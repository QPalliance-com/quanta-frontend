<p-toolbar styleClass="mb-6">
    <ng-template #start>
        <p-button label="Nuevo" icon="pi pi-plus" severity="secondary" class="mr-2" (onClick)="openNew()" />
        <!-- <p-button severity="secondary" label="Delete" icon="pi pi-trash" outlined (onClick)="deleteSelectedProducts()" [disabled]="!selectedProducts || !selectedProducts.length" /> -->
    </ng-template>

    <ng-template #end>
        <!-- <p-button label="Export" icon="pi pi-upload" severity="secondary" (onClick)="exportCSV()" /> -->
    </ng-template>
</p-toolbar>
<p-panel header="Solicitudes de compra">
    <div class="card" *ngIf="orders() && orders().length > 0">
        <p-table
            [value]="orders()"
            [paginator]="true"
            [rows]="10"
            responsiveLayout="scroll"
            [resizableColumns]="true"
            [scrollable]="true"
            scrollHeight="500px"
            [showCurrentPageReport]="true"
            currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords}"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th class="px-4 py-2">ID</th>
                    <th class="px-4 py-2">Empresa</th>
                    <th class="px-4 py-2">Proveedor</th>
                    <th class="px-4 py-2">Recepción</th>
                    <th class="px-4 py-2">Vencimiento</th>
                    <th class="px-4 py-2">Días entrega</th>
                    <th class="px-4 py-2">CECO</th>
                    <th class="px-4 py-2">% Participación</th>
                    <th class="px-4 py-2">Estado</th>

                    <th class="text-center">Acciones</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-order>
                <tr>
                    <td class="px-4 py-2">{{ order.id }}</td>
                    <td class="px-4 py-2">{{ order.companyName }}</td>
                    <td class="px-4 py-2">{{ order.supplierId }}</td>
                    <td class="px-4 py-2">{{ order.receptionDate | date: 'yyyy-MM-dd' }}</td>
                    <td class="px-4 py-2">{{ order.dueDate | date: 'yyyy-MM-dd' }}</td>
                    <td class="px-4 py-2">{{ order.deliveryDays }}</td>
                    <td class="px-4 py-2">{{ order.ceco.label }}</td>
                    <td class="px-4 py-2">{{ order.participation }}%</td>
                    <td class="px-4 py-2">
                        <span
                            class="px-2 py-1 rounded text-white"
                            [ngClass]="{
                                'bg-blue-500': order.status === 'Solicitada',
                                'bg-yellow-500': order.status?.includes('Enviada'),
                                'bg-red-500': order.status === 'Rechazada',
                                'bg-green-500': order.status === 'Aceptada'
                            }"
                        >
                            {{ order.status }}
                        </span>
                    </td>

                    <td class="text-center">
                        <button pButton icon="pi pi-eye" class="p-button-sm p-button-rounded p-button-text p-button-info" (click)="viewPurchaseOrder(order)" title="Ver solicitud de compra"></button>
                        <button pButton icon="pi pi-pencil" class="p-button-sm p-button-rounded p-button-text" (click)="editPurchaseOrder(order)"></button>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
    <p-confirmdialog />
    <!-- <p-dialog header="Detalle del proveedor" [(visible)]="displayViewDialog" [modal]="true" [style]="{ width: '800px' }">
        <div *ngIf="selectedSupplier" class="grid grid-cols-2 gap-2 text-sm">
            <div><b>Empresa:</b> {{ selectedSupplier.companyName }}</div>
            <div><b>Contacto:</b> {{ selectedSupplier.contactName }}</div>
            <div><b>Tipo Documento:</b> {{ selectedSupplier.documentType }}</div>
            <div><b>Número:</b> {{ selectedSupplier.documentNumber }}</div>
            <div *ngIf="selectedSupplier.dv"><b>DV:</b> {{ selectedSupplier.dv }}</div>
            <div><b>Email:</b> {{ selectedSupplier.email }}</div>
            <div><b>Teléfono:</b> {{ selectedSupplier.phone }}</div>
            <div><b>Dirección:</b> {{ selectedSupplier.address }}</div>
            <div><b>Departamento:</b> {{ departmentsMap.get(selectedSupplier.departmentId) }}</div>
            <div><b>Ciudad:</b> {{ citiesMap.get(selectedSupplier.cityId) }}</div>
            <div><b>Plazo pago:</b> {{ selectedSupplier.paymentTerm }} días</div>
            <div><b>Crédito: </b> {{ selectedSupplier.creditLimit | currency: 'COP' }}</div>
            <div><b>Vendedor:</b> {{ selectedSupplier.salesRep }}</div>
        </div>
    </p-dialog> -->
</p-panel>
