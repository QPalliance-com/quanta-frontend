<p-toast></p-toast>
<div class="card flex flex-col gap-6 w-full">
    <h2 class="text-2xl font-semibold mb-6">Orden de compra</h2>
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="p-6 space-y-6">
        <!-- Sección: Información de la Orden -->
        <div>
            <h2 class="text-lg font-semibold mb-4">Información de la Orden</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Nombre de la empresa</label>
                    <input pInputText formControlName="companyName" class="w-full" readonly />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Proveedor</label>
                    <p-select formControlName="supplierId" [options]="suppliers" optionLabel="companyName" optionValue="id" placeholder="Seleccione proveedor" class="w-full" />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de recepción</label>
                    <p-datePicker formControlName="receptionDate" dateFormat="yy-mm-dd" showIcon class="w-full" />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de vencimiento</label>
                    <p-datePicker formControlName="dueDate" dateFormat="yy-mm-dd" showIcon class="w-full" />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Días para entregar</label>
                    <p-inputNumber formControlName="deliveryDays" [min]="0" class="w-full" />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Centro de costo</label>
                    <p-select formControlName="ceco" [options]="cecoOptions" optionLabel="label" placeholder="Seleccione" class="w-full" />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">% Participación</label>
                    <p-inputNumber formControlName="participation" suffix="%" [min]="0" [max]="100" class="w-full" />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Estado</label>
                    <p-select [disabled]="!editMode" [readonly]="!editMode" formControlName="status" [options]="statusOptions" placeholder="Seleccione estado" class="w-full" />
                </div>
            </div>
        </div>

        <!-- Sección: Ítems de la Orden -->
        <div>
            <h2 class="text-lg font-semibold mb-4 mt-8">Ítems de la Orden</h2>
            <div class="grid grid-cols-1 md:grid-cols-1 gap-6">
                <app-purchase-items-table [itemsFormArray]="itemsFormArray" />
            </div>
        </div>

        <!-- Botones -->
        <div class="flex justify-end gap-4 pt-6 border-t mt-6">
            <button pButton type="button" class="p-button-secondary" (click)="cancel()">Cancelar</button>
            <button pButton type="submit" label="Guardar" [disabled]="form.invalid"></button>
        </div>
    </form>
</div>
